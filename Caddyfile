{
    # Global options
    admin off  # Disable admin interface for security
}

:80 {
    log {
        output file /var/log/caddy/access.log
        format json
    }

    # Handle errors
    handle_errors {
        respond "{err.status_code} {err.message}"
    }

    # Load balance configuration
    reverse_proxy {
        to :1323 :1324 :1325

        # Load balancing policy
        lb_policy round_robin

        # Health checks
        health_uri /health
        health_interval 10s
        health_timeout 5s
        health_status 200

        # Transports
        transport http {
            keepalive 30s
            keepalive_idle_conns 10
        }
    }
}
